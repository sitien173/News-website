<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{/fragments/admin/head::head}">
    <title>User Management</title>
</head>
<body>
<div th:replace="~{/fragments/admin/header::header}"></div>
<div class="container-xxl my-md-4 bd-layout">
    <div th:replace="~{/fragments/admin/nav::nav}"></div>

</div>
<main class="container-fluid bd-main order-1 d-flex align-items-center">
   <div class="container">
       <div class="bd-intro ps-lg-4">
           <div class="d-md-flex flex-md-row-reverse align-items-center justify-content-between">
               <a class="btn btn-sm btn-bd-light mb-2 mb-md-0" href="#" style="visibility: hidden" title="View and edit this file on GitHub" target="_blank" rel="noopener"></a>
               <h2 class="bd-title text-primary" id="content">Quản Lí Nhân Viên</h2>
               <div class="d-inline-flex p-2">
                   <a class="btn btn-primary ms-1 " data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                       thêm
                   </a>
                   <a id="edit" class="btn btn-warning ms-1 disabled">
                       sửa
                   </a>
                   <a id="delete" class="btn btn-danger ms-1 disabled" href="#">
                       <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-backspace-reverse-fill" viewBox="0 0 16 16">
                           <path d="M0 3a2 2 0 0 1 2-2h7.08a2 2 0 0 1 1.519.698l4.843 5.651a1 1 0 0 1 0 1.302L10.6 14.3a2 2 0 0 1-1.52.7H2a2 2 0 0 1-2-2V3zm9.854 2.854a.5.5 0 0 0-.708-.708L7 7.293 4.854 5.146a.5.5 0 1 0-.708.708L6.293 8l-2.147 2.146a.5.5 0 0 0 .708.708L7 8.707l2.146 2.147a.5.5 0 0 0 .708-.708L7.707 8l2.147-2.146z"/>
                       </svg>
                       xoá
                   </a>
                   <a th:href="@{/admin/user-management(refresh=true)}" class="btn btn-success ms-1">
                       <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                           <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"></path>
                           <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"></path>
                       </svg>
                       refresh
                   </a>
               </div>
           </div>
       </div>

       <div class="container-fluid bd-content ps-lg-4">
           <div class="bd-example">
               <div class="table-responsive">
                   <form id="form-table" method="post" th:action="@{/admin/user-management/delete}">
                       <table id="table" class="table table-hover table align-middle">
                           <caption>List of users</caption>
                           <thead>
                           <tr>
                               <th scope="col">
                                   <fieldset class="form-check">
                                       <input name="usersCheck" type="checkbox" class="form-check-input" id="selectAll">
                                   </fieldset>
                               </th>
                               <th scope="col">Họ</th>
                               <th scope="col">Tên</th>
                               <th scope="col">Email</th>
                               <th scope="col">Trạng Thái</th>
                               <th scope="col">Xác Thực</th>
                               <th scope="col">Role</th>
                               <th scope="col">Ngày Tạo</th>
                           </tr>
                           </thead>
                           <tbody>
                           <th:block th:each="user : ${users}">
                               <tr th:id="${user.id}">
                                   <th scope="row">
                                       <fieldset class="form-check">
                                           <input name="userId" th:value="${user.id}" type="checkbox" class="form-check-input">
                                       </fieldset>
                                   </th>
                                   <td th:text="${user.firstName}"></td>
                                   <td th:text="${user.lastName}"></td>
                                   <td th:text="${user.email}"></td>
                                   <th:block th:switch="${user.isAccountNonLocked}">
                                       <td class="text-danger" th:case="false">Lock</td>
                                       <td class="text-primary" th:case="true">Active</td>
                                       <td th:case="*">Không Xác Định</td>
                                   </th:block>
                                   <th:block th:switch="${user.isEnable}">
                                       <td class="text-primary" th:case="true">Confirmed</td>
                                       <td class="text-danger" th:case="false">unconfirmed</td>
                                       <td th:case="*">Không Xác Định</td>
                                   </th:block>
                                   <td th:text="${user.role.name()}"></td>
                                   <td th:text="${user.createAt.toString().replace('T',' ')}"></td>
                               </tr>
                           </th:block>
                           </tbody>
                           <tfoot>
                           <tr>
                               <th class="invisible"></th>
                               <th>Họ</th>
                               <th>Tên</th>
                               <th>Email</th>
                               <th class="invisible"></th>
                               <th class="invisible"></th>
                               <th class="invisible"></th>
                               <th class="invisible"></th>
                           </tr>
                           </tfoot>
                       </table>
                   </form>
               </div>

           </div>
       </div>
   </div>
        <!--       if choose new user -->
    <div id="new-user" class="d-none container">
        <div class="collapse" id="collapseExample">
            <div class="card card-body">
                <form id="form" class="row g-3" th:action="@{/admin/user-management/add}"
                      method="post" th:object="${appUser}" enctype="multipart/form-data">
                    <div class="col-md-6">
                        <label for="firstName" class="form-label">Họ</label>
                        <input required placeholder="Họ" type="text" class="form-control" th:field="*{firstName}" id="firstName">
                        <p th:if="${#fields.hasErrors('firstName')}" class="text-danger"
                           th:errors="*{firstName}"></p>
                    </div>
                    <div class="col-md-6">
                        <label for="lastName" class="form-label">Tên</label>
                        <input required placeholder="Tên" type="text" class="form-control" th:field="*{lastName}" id="lastName">
                        <p th:if="${#fields.hasErrors('lastName')}" class="text-danger"
                           th:errors="*{lastName}"></p>
                    </div>
                    <div class="col-md-6">
                        <label for="email" class="form-label">Email</label>
                        <input required placeholder="Email" type="email" th:field="*{email}"  class="form-control" id="email">
                        <span class="d-none text-danger" id="email-error"></span>
                        <p th:if="${#fields.hasErrors('email')}" class="text-danger"
                           th:errors="*{email}"></p>
                    </div>
                    <div class="col-md-6">
                        <label for="file" class="form-label">Ảnh đại diện</label>
                        <input accept="image/*" type="file" class="form-control" id="file" name="file">
                        <div class="progress" style="background-color: white">
                            <div class="progress-bar" role="progressbar" id="process-bar" style="width: 0;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                        </div>
                        <span class="d-none text-danger" id="avt-error"></span>
                    </div>
                    <div class="col-md-6">
                        <label for="password" class="form-label">Mật khẩu</label>
                        <input required placeholder="Mật khẩu" pattern="^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,100}$" type="password" th:field="*{password}" class="form-control" id="password">
                        <p th:if="${#fields.hasErrors('password')}" class="text-danger"
                           th:errors="*{password}"></p>
                    </div>
                    <div class="col-md-6">
                        <label for="re-password" class="form-label">Nhập lại mật khẩu</label>
                        <input required placeholder="Nhập lại mật khẩu" pattern="^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,100}$" type="password" class="form-control" id="re-password">
                        <p th:if="${#fields.hasErrors('password')}" class="text-danger"
                           th:errors="*{password}"></p>
                    </div>
                    <div class="col-md-4">
                        <label for="roles" class="form-label">Role</label>
                        <select th:field="*{role}" id="roles" class="form-select">
                            <option selected value="USER">USER</option>
                            <option value="ADMIN">ADMIN</option>
                        </select>
                    </div>

                    <div class="col-md-4">
                        <fieldset class="form-check">
                            <input th:field="*{isAccountNonLocked}" type="checkbox" class="form-check-input" id="isAccountNonLocked">
                            <label for="isAccountNonLocked" class="form-check-label">Bật trạng thái</label>
                        </fieldset>
                    </div>

                    <div class="col-md-4">
                        <fieldset class="form-check">
                            <input th:field="*{isEnable}" type="checkbox" class="form-check-input" id="isEnable"    >
                            <label for="isEnable" class="form-check-label">Bỏ qua xác thực</label>
                        </fieldset>
                    </div>

                    <div class="col-12">
                        <button type="submit" id="btn-submit" class="btn btn-primary">Thêm</button>
                        <button type="reset"  class="btn btn-primary">Reset</button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</main>
<div th:insert="~{/fragments/admin/import-script::import-script}"></div>
<script th:src="@{/script/admin/user-management.js}"></script>
</body>
</html>